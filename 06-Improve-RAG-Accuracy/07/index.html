
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Build custom AI-powered solutions on top of Azure Database for PostgreSQL and Azure AI.">
      
      
        <meta name="author" content="Solliance">
      
      
        <link rel="canonical" href="https://solliancenet.github.io/microsoft-postgresql-solution-accelerator-build-your-own-ai-copilot/06-Improve-RAG-Accuracy/07/">
      
      
        <link rel="prev" href="../06/">
      
      
        <link rel="next" href="../08/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.50">
    
    
      
        <title>6.7 Create Graph Database - Build your own AI Copilot for FSI with PostgreSQL: Workshop Guide</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.a40c8224.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#67-create-graph-database" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Build your own AI Copilot for FSI with PostgreSQL: Workshop Guide" class="md-header__button md-logo" aria-label="Build your own AI Copilot for FSI with PostgreSQL: Workshop Guide" data-md-component="logo">
      
  <img src="../../img/postgresql.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Build your own AI Copilot for FSI with PostgreSQL: Workshop Guide
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              6.7 Create Graph Database
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="pink"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 2c-1.82 0-3.53.5-5 1.35C8 5.08 10 8.3 10 12s-2 6.92-5 8.65C6.47 21.5 8.18 22 10 22a10 10 0 0 0 10-10A10 10 0 0 0 10 2"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="amber" data-md-color-accent="cyan"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/solliancenet/microsoft-postgresql-solution-accelerator-build-your-own-ai-copilot" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    solliancenet/microsoft-postgresql-solution-accelerator-build-your-own-ai-copilot
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Before You Begin

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../01-Introduction/" class="md-tabs__link">
          
  
    
  
  01 Introduction

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../02-Setup/" class="md-tabs__link">
          
  
    
  
  02 Setup

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../03-Integrate-AI-Into-PostgreSQL/" class="md-tabs__link">
          
  
    
  
  03 Integrate AI Into PostgreSQL

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../04-Create-AI-Pipeline/" class="md-tabs__link">
          
  
    
  
  04 Create AI Pipeline

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../05-Build-Copilot/" class="md-tabs__link">
          
  
    
  
  05 Build Copilot

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
    
  
  06 Improve RAG Accuracy

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../07-Redeploy/" class="md-tabs__link">
          
  
    
  
  07 Redeploy

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../Tear-Down/" class="md-tabs__link">
          
  
    
  
  Tear Down

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Build your own AI Copilot for FSI with PostgreSQL: Workshop Guide" class="md-nav__button md-logo" aria-label="Build your own AI Copilot for FSI with PostgreSQL: Workshop Guide" data-md-component="logo">
      
  <img src="../../img/postgresql.svg" alt="logo">

    </a>
    Build your own AI Copilot for FSI with PostgreSQL: Workshop Guide
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/solliancenet/microsoft-postgresql-solution-accelerator-build-your-own-ai-copilot" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    solliancenet/microsoft-postgresql-solution-accelerator-build-your-own-ai-copilot
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Before You Begin
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../01-Introduction/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    01 Introduction
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            01 Introduction
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01-Introduction/01-App-Scenario/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.1 The App Scenario
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01-Introduction/02-App-Architecture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.2 Application Architecture
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01-Introduction/03-Data-Structure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.3 Understand the Table Schema and Artifacts
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../02-Setup/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    02 Setup
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            02 Setup
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../02-Setup/0-Prerequisites/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    0 Prerequisites
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            0 Prerequisites
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    1 Environment Prep
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            1 Environment Prep
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02-Setup/1-Environment-Prep/01-Install-Software/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A. Install Software
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02-Setup/1-Environment-Prep/02-Fork-Repo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    B. Fork Repo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02-Setup/1-Environment-Prep/03-Verify-Azure-Quota/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    C. Verify Azure Quota
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../02-Setup/2-Provision-And-Deploy/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    2 Provision And Deploy
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            2 Provision And Deploy
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02-Setup/2-Provision-And-Deploy/01-Self-Guided/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Self-Guided Setup
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02-Setup/2-Provision-And-Deploy/02-Instructor-Led/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Instructor-Led Workshop Setup
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../02-Setup/3-Validation/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    3 Validation
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            3 Validation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../02-Setup/4-Setup-Dev-Env/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    4 Setup Dev Env
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            4 Setup Dev Env
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../02-Setup/5-Review-Manual-Process/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    5 Review Manual Process
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_7">
            <span class="md-nav__icon md-icon"></span>
            5 Review Manual Process
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../03-Integrate-AI-Into-PostgreSQL/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    03 Integrate AI Into PostgreSQL
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            03 Integrate AI Into PostgreSQL
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../03-Integrate-AI-Into-PostgreSQL/01/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.1 Install extensions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../03-Integrate-AI-Into-PostgreSQL/02/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.2 Configure the Azure AI extension
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../03-Integrate-AI-Into-PostgreSQL/03/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.3 Enable vector storage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../03-Integrate-AI-Into-PostgreSQL/04/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.4 Optimize Vector Query Performance
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../03-Integrate-AI-Into-PostgreSQL/05/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.5 Vectorize data
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../04-Create-AI-Pipeline/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    04 Create AI Pipeline
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            04 Create AI Pipeline
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04-Create-AI-Pipeline/01/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.1 Extract Data with Document Intelligence
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04-Create-AI-Pipeline/02/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.2 Configure Semantic Chunking
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04-Create-AI-Pipeline/03/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.3 Summarize documents
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04-Create-AI-Pipeline/04/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.4 Validate Data with Azure OpenAI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04-Create-AI-Pipeline/05/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.5 Review Validation Prompts
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../05-Build-Copilot/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    05 Build Copilot
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            05 Build Copilot
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../05-Build-Copilot/01/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.1 Explore the API Codebase
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../05-Build-Copilot/02/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.2 Review RAG Design
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../05-Build-Copilot/03/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.3 Leverage LangChain Orchestration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../05-Build-Copilot/04/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.4 Enable the Chat Endpoint
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../05-Build-Copilot/05/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.5 Test the Chat API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../05-Build-Copilot/06/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.6 Add Copilot Chat To UI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../05-Build-Copilot/07/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.7 Test the UI Copilot Chat
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../05-Build-Copilot/08/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.8 Refine the Copilot Prompt
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    06 Improve RAG Accuracy
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7" id="__nav_7_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            06 Improve RAG Accuracy
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.1 Understand Semantic Ranking
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.2 Use Semantic Ranking in PostgreSQL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.3 Update Copilot With Semantic Ranking
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.4 Review GraphRAG
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.5 Enable AGE
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.6 Export Graph Data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    6.7 Create Graph Database
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    6.7 Create Graph Database
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#create-graph-database-with-agefreighter" class="md-nav__link">
    <span class="md-ellipsis">
      Create Graph Database with AGEFreighter
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#review-code" class="md-nav__link">
    <span class="md-ellipsis">
      Review code
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#update-env-file" class="md-nav__link">
    <span class="md-ellipsis">
      Update .env file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#load-the-graph-database" class="md-nav__link">
    <span class="md-ellipsis">
      Load the graph database
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#verify-data-load" class="md-nav__link">
    <span class="md-ellipsis">
      Verify data load
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../08/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.8 Update Copilot With GraphRAG
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../07-Redeploy/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    07 Redeploy
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            07 Redeploy
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_9" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../Tear-Down/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Tear Down
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Tear Down
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#create-graph-database-with-agefreighter" class="md-nav__link">
    <span class="md-ellipsis">
      Create Graph Database with AGEFreighter
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#review-code" class="md-nav__link">
    <span class="md-ellipsis">
      Review code
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#update-env-file" class="md-nav__link">
    <span class="md-ellipsis">
      Update .env file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#load-the-graph-database" class="md-nav__link">
    <span class="md-ellipsis">
      Load the graph database
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#verify-data-load" class="md-nav__link">
    <span class="md-ellipsis">
      Verify data load
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="67-create-graph-database">6.7 Create Graph Database<a class="headerlink" href="#67-create-graph-database" title="Permanent link">&para;</a></h1>
<p>Hosting graph databases in Azure Database for PostgreSQL using the Apache AGE extension offers a powerful way to analyze relationships within your data. AGE combines graph and relational data seamlessly, leveraging the openCypher query language for efficient graph processing. This integration brings PostgreSQL's scalability, performance, and security to the table while enabling advanced data analysis and management. When incorporated into a copilot, this setup empowers you to evaluate vendor performance of SOW deliverables through invoice validation, ensuring your data-driven decisions are robust and insightful.</p>
<h2 id="create-graph-database-with-agefreighter">Create Graph Database with AGEFreighter<a class="headerlink" href="#create-graph-database-with-agefreighter" title="Permanent link">&para;</a></h2>
<p><a href="https://github.com/rioriost/agefreighter/">AGEFreighter</a> is a Python library designed to simplify the process of creating and loading graph databases in Azure Database for PostgreSQL, allowing data to be ingested from various sources, including file formats (CSV, AVRO, and Parquet), Azure Storage, Azure Cosmos DB, and Azure Database for PostgreSQL.</p>
<h2 id="review-code">Review code<a class="headerlink" href="#review-code" title="Permanent link">&para;</a></h2>
<p>The solution accelerator includes the <code>graph_loader.py</code> file in the <code>src/api/app</code> folder, which allows you to quickly run a Python script to create a graph database and populate it with data from CSV files.</p>
<p>The graph loader is implemented in the <code>src/api/app/graph_loader.py</code> file. Open it now in Visual Studio Code and explore the code in sections. You can also expand the section below to see the code inline and review explanations for the code.</p>
<details class="info" open="open">
<summary>Graph Loader code</summary>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">src/api/app/graph_loader.py</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">agefreighter</span> <span class="kn">import</span> <span class="n">Factory</span>
<span class="kn">from</span> <span class="nn">dotenv</span> <span class="kn">import</span> <span class="n">load_dotenv</span>
<span class="kn">from</span> <span class="nn">azure.identity</span> <span class="kn">import</span> <span class="n">DefaultAzureCredential</span>
<span class="kn">from</span> <span class="nn">azure.storage.blob.aio</span> <span class="kn">import</span> <span class="n">BlobServiceClient</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load data into Azure Database for PostgreSQL Graph Database.&quot;&quot;&quot;</span>
    <span class="c1"># Load environment variables from the .env file</span>
    <span class="n">load_dotenv</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Loading environment variables...&quot;</span><span class="p">)</span>

    <span class="c1"># Get environment variables</span>
    <span class="n">server</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;POSTGRESQL_SERVER_NAME&quot;</span><span class="p">)</span>
    <span class="n">database</span> <span class="o">=</span> <span class="s1">&#39;contracts&#39;</span>
    <span class="n">username</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;ENTRA_ID_USERNAME&quot;</span><span class="p">)</span>
    <span class="n">account_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;STORAGE_ACCOUNT_NAME&quot;</span><span class="p">)</span>

    <span class="c1"># Create an AGEFreigher factory instance to load data from multiple CSV files.</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Creating AGEFreighter factory instance...&quot;</span><span class="p">)</span>
    <span class="n">factory</span> <span class="o">=</span> <span class="n">Factory</span><span class="o">.</span><span class="n">create_instance</span><span class="p">(</span><span class="s1">&#39;MultiCSVFreighter&#39;</span><span class="p">)</span>

    <span class="c1"># Connect to the PostgreSQL database.</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Connecting to the PostgreSQL database...&quot;</span><span class="p">)</span>
    <span class="k">await</span> <span class="n">factory</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
        <span class="n">dsn</span><span class="o">=</span><span class="n">get_connection_string</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="n">database</span><span class="p">,</span> <span class="n">username</span><span class="p">),</span>
        <span class="n">max_connections</span><span class="o">=</span><span class="mi">64</span>
    <span class="p">)</span>

    <span class="n">local_data_dir</span> <span class="o">=</span> <span class="s1">&#39;graph_data/&#39;</span>

    <span class="c1"># Download CSV data files from Azure Blob Storage</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Downloading CSV files from Azure Blob Storage...&quot;</span><span class="p">)</span>
    <span class="k">await</span> <span class="n">download_csvs</span><span class="p">(</span><span class="n">account_name</span><span class="p">,</span> <span class="n">local_data_dir</span><span class="p">)</span>

    <span class="c1"># Load data into the graph database</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Loading data into the graph database...&quot;</span><span class="p">)</span>
    <span class="k">await</span> <span class="n">factory</span><span class="o">.</span><span class="n">load</span><span class="p">(</span>
        <span class="n">graph_name</span><span class="o">=</span><span class="s1">&#39;vendor_graph&#39;</span><span class="p">,</span>
        <span class="n">vertex_csv_paths</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">local_data_dir</span><span class="si">}</span><span class="s1">vendors.csv&#39;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">local_data_dir</span><span class="si">}</span><span class="s1">sows.csv&#39;</span>
        <span class="p">],</span>
        <span class="n">vertex_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;vendor&#39;</span><span class="p">,</span> <span class="s1">&#39;sow&#39;</span><span class="p">],</span>
        <span class="n">edge_csv_paths</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">local_data_dir</span><span class="si">}</span><span class="s1">has_invoices.csv&#39;</span><span class="p">],</span>
        <span class="n">edge_types</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;has_invoices&quot;</span><span class="p">],</span>
        <span class="n">use_copy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">drop_graph</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">create_graph</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">progress</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Graph data loaded successfully!&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_connection_string</span><span class="p">(</span><span class="n">server_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">database_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the connection string for the PostgreSQL database.&quot;&quot;&quot;</span>

    <span class="c1"># Get a token for the Azure Database for PostgreSQL server</span>
    <span class="n">credential</span> <span class="o">=</span> <span class="n">DefaultAzureCredential</span><span class="p">()</span>
    <span class="n">token</span> <span class="o">=</span> <span class="n">credential</span><span class="o">.</span><span class="n">get_token</span><span class="p">(</span><span class="s2">&quot;https://ossrdbms-aad.database.windows.net&quot;</span><span class="p">)</span>
    <span class="n">port</span> <span class="o">=</span> <span class="mi">5432</span>

    <span class="n">conn_str</span> <span class="o">=</span> <span class="s2">&quot;host=</span><span class="si">{}</span><span class="s2"> port=</span><span class="si">{}</span><span class="s2"> dbname=</span><span class="si">{}</span><span class="s2"> user=</span><span class="si">{}</span><span class="s2"> password=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">server_name</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">database_name</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">token</span><span class="o">.</span><span class="n">token</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">conn_str</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">download_csvs</span><span class="p">(</span><span class="n">account_name</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">local_data_directory</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Download CSV files from Azure Blob Storage.&quot;&quot;&quot;</span>

    <span class="c1"># Create connection to the blob storage account</span>
    <span class="n">account_blob_endpoint</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://</span><span class="si">{</span><span class="n">account_name</span><span class="si">}</span><span class="s2">.blob.core.windows.net/&quot;</span>
    <span class="c1"># Connect to the blob service client using Entra ID authentication</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">BlobServiceClient</span><span class="p">(</span><span class="n">account_url</span><span class="o">=</span><span class="n">account_blob_endpoint</span><span class="p">,</span> <span class="n">credential</span><span class="o">=</span><span class="n">DefaultAzureCredential</span><span class="p">())</span>

    <span class="c1"># List the blobs in the graph container with a CSV extension</span>
    <span class="k">async</span> <span class="k">with</span> <span class="n">client</span><span class="p">:</span>
        <span class="k">async</span> <span class="k">for</span> <span class="n">blob</span> <span class="ow">in</span> <span class="n">client</span><span class="o">.</span><span class="n">get_container_client</span><span class="p">(</span><span class="s1">&#39;graph&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">list_blobs</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">blob</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.csv&#39;</span><span class="p">):</span>
                <span class="c1"># Download the CSV file to a local directory</span>
                <span class="k">await</span> <span class="n">download_csv</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">blob</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">local_data_directory</span><span class="p">)</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">download_csv</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">BlobServiceClient</span><span class="p">,</span> <span class="n">blob_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">local_data_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Download a CSV file from Azure Blob Storage.&quot;&quot;&quot;</span>
    <span class="c1"># Get the blob</span>
    <span class="n">blob_client</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_blob_client</span><span class="p">(</span><span class="n">container</span><span class="o">=</span><span class="s1">&#39;graph&#39;</span><span class="p">,</span> <span class="n">blob</span><span class="o">=</span><span class="n">blob_path</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">with</span> <span class="n">blob_client</span><span class="p">:</span>
        <span class="c1"># Download the CSV file</span>
        <span class="k">if</span> <span class="k">await</span> <span class="n">blob_client</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="c1"># create a local directory if it does not exist</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">local_data_dir</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">local_data_dir</span><span class="p">)</span>

            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">local_data_dir</span><span class="si">}{</span><span class="n">blob_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                <span class="n">stream</span> <span class="o">=</span> <span class="k">await</span> <span class="n">blob_client</span><span class="o">.</span><span class="n">download_blob</span><span class="p">()</span>
                <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">stream</span><span class="o">.</span><span class="n">readall</span><span class="p">()</span>
                <span class="c1"># Save the CSV file to a local directory</span>
                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">asyncio</span>
    <span class="kn">import</span> <span class="nn">sys</span>

    <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s2">&quot;win32&quot;</span><span class="p">:</span>
        <span class="n">asyncio</span><span class="o">.</span><span class="n">set_event_loop_policy</span><span class="p">(</span><span class="n">asyncio</span><span class="o">.</span><span class="n">WindowsSelectorEventLoopPolicy</span><span class="p">())</span>

    <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
</details>
<ol>
<li>
<p><strong>Import libraries</strong> (lines 1-5): Required classes and functions are imported from various libraries.</p>
</li>
<li>
<p><strong>Define <code>main</code> function</strong> (line 7): The <code>main</code> function is the entry point of the graph loader. This function serves as the orchestrator for executing the code within the file.</p>
</li>
<li>
<p><strong>Load environment variables</strong> (lines 10-17): The <code>load_dotenv()</code> method from the <code>dotenv</code> Python library allows variables from the <code>.env</code> file within the API project to be loaded as environment variables in the project. Note the names of the variables here, as you will be adding those to your <code>.env</code> file in the next step.</p>
</li>
<li>
<p><strong>Create an AGEFreighter factory</strong> (line 21): The entry point for the <code>agefreighter</code> package in the <code>factory</code> class. This method creates an instance of the library using the type specified. You are loading your graph using multiple CSV files, so the <code>MultiCSVFreighter</code> class type is indicated.</p>
</li>
<li>
<p><strong>Connect to PostgreSQL</strong> (lines 25-28): The <code>connect</code> method of the <code>factory</code> opens a connection to your Azure Database for PostgreSQL flexible server.</p>
<ol>
<li>The <code>get_connection_string()</code> function uses values from your environment variables to define the connection string the <code>factory</code> will use to connect to your database.</li>
<li>The <code>get_connection_string()</code> function is defined on lines 55-66.</li>
</ol>
</li>
<li>
<p><strong>Download CSV files from blob storage</strong> (line 34): The CSV files you created in the previous task are downloaded from blob storage and written into a local folder, where the graph loader can easily access them.</p>
<ol>
<li>The <code>download_csvs()</code> function is defined on lines 68-81. This function creates a <code>BlobServiceClient</code> instance, which is used to retrieve the blobs in your storage account's <code>graph</code> container.</li>
<li>For each blob with the extension of <code>.csv</code>, the <code>download_csv</code> function defined on lines 83-99 is used to retrieve the blob's contents and write them into a local file.</li>
</ol>
</li>
<li>
<p><strong>Create and load the graph database</strong> (lines 38-51): The <code>load</code> method of the <code>factory</code> does the following:</p>
<ol>
<li>Creates a graph named <code>vendor_graph</code>.</li>
<li>Defines vertex (node) data and labels and inserts the nodes into the graph.</li>
<li>Specifies edges using labels and inserts them to establish the relationships between the nodes.</li>
</ol>
</li>
<li>
<p><strong>Define the main guard</strong> (lines 101-108): The main guard defines how the <code>graph_loader</code> is executed when called directly. This code block lets you run the script from a command line or VS Code debugging session.</p>
</li>
</ol>
<h2 id="update-env-file">Update <code>.env</code> file<a class="headerlink" href="#update-env-file" title="Permanent link">&para;</a></h2>
<p>The <code>graph_loader.py</code> file references environment variables to retrieve information about your Azure Database for PostgreSQL flexible server instance, your Entra ID username, and the storage account from which to pull CSV files. Before executing the graph loader script, you must update your project's <code>.env</code> file with these values. The <code>.env</code> file can be found in the <code>src\api\app</code> folder of the repo.</p>
<ol>
<li>
<p>In VS Code, navigate to the <code>src\api\app</code> folder in the <strong>Explorer</strong> panel.</p>
</li>
<li>
<p>Open the <code>.env</code> file and add the following lines:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="na">ENTRA_ID_USERNAME</span><span class="o">=</span><span class="s">&quot;{YOUR_ENTRA_ID_USERNAME}&quot;</span>
<span class="na">POSTGRESQL_SERVER_NAME</span><span class="o">=</span><span class="s">&quot;{YOUR_POSTGRESQL_SERVER_NAME}&quot;</span>
<span class="na">STORAGE_ACCOUNT_NAME</span><span class="o">=</span><span class="s">&quot;{YOUR_STORAGE_ACCOUNT_NAME}&quot;</span>
</code></pre></div></td></tr></table></div>
<details class="tip" open="open">
<summary>Follow these steps to retrieve the necessary values</summary>
<ol>
<li>
<p>Replace the <code>{YOUR_ENTRA_ID_USERNAME}</code> token in the <code>ENTRA_ID_USERNAME</code> variable's value with your Microsoft Entra ID, which should be the email address of the account you are using for this solution accelerator.</p>
</li>
<li>
<p>Replace the <code>{YOUR_POSTGRESQL_SERVER_NAME}</code> token with the name of your PostgreSQL server. To get your server name:</p>
</li>
<li>
<p>Navigate to your Azure Database for PostgreSQL flexible server resource in the <a href="https://portal.azure.com/">Azure portal</a>.</p>
</li>
<li>
<p>In the <strong>Essentials</strong> panel of the PostgreSQL flexible server's <strong>Overview</strong> page, copy the <strong>Server name</strong> value and paste it into your <code>.env</code> file as the <code>POSTGRESQL_SERVER_NAME</code> value.</p>
<p><img alt="Screenshot of the Azure Database for PostgreSQL page in the Azure portal with the server name highlighted in the Overview Essentials panel." src="../../img/azure-postgresql-server-name.png" /></p>
</li>
<li>
<p>Replace the <code>{YOUR_STORAGE_ACCOUNT_NAME}</code> token with the name of your storage account. To retrieve your storage account name:</p>
</li>
<li>
<p>In the Azure portal, navigate to the Storage account resource in your resource group.</p>
</li>
<li>
<p>On the Storage account page, copy the storage account name and paste it into your <code>.env</code> file as the <code>STORAGE_ACCOUNT_NAME</code> value.</p>
<p><img alt="Screenshot of the App Configuration Access Settings page, with the Endpoint copy button highlighted." src="../../img/azure-storage-account-name.png" /></p>
</li>
</ol>
</details>
</li>
<li>
<p>Save the <code>.env</code> file.</p>
</li>
</ol>
<h2 id="load-the-graph-database">Load the graph database<a class="headerlink" href="#load-the-graph-database" title="Permanent link">&para;</a></h2>
<p>You will use a VS Code debugging session to locally execute the <code>graph_loader.py</code> script. Follow the steps below to start a <em>Graph Loader</em> debug session in VS Code.</p>
<ol>
<li>
<p>In Visual Studio Code <strong>Run and Debug</strong> panel, select the <strong>Graph Loader</strong> option from the debug configurations dropdown list.</p>
<p><img alt="Screenshot of the Run and Debug panel, with the Run and Debug configurations dropdown list expanded and the Graph Loader option highlighted." src="../../img/vs-code-run-and-debug-selection-graph-loader.png" /></p>
</li>
<li>
<p>Select the <strong>Start Debugging</strong> button (or press F5 on your keyboard).</p>
<p><img alt="Screenshot of the Start Debugging button highlighted next to the Run and Debug configurations dropdown list." src="../../img/vs-code-start-debugging-graph-loader.png" /></p>
</li>
<li>
<p>Wait for the graph loader to finish running, indicated by the <code>Graph data loaded successfully!</code> message in the terminal output.</p>
<p><img alt="Screenshot of the output panel, with Graph data loaded successfully highlighted." src="../../img/vs-code-graph-loader-complete.png" /></p>
</li>
</ol>
<h2 id="verify-data-load">Verify data load<a class="headerlink" href="#verify-data-load" title="Permanent link">&para;</a></h2>
<p>You will execute openCypher queries using <strong>pgAdmin</strong> to verify the data load and explore relationships in your graph database.</p>
<ol>
<li>
<p>Return to <strong>pgAdmin</strong> and ensure it is connected to your PostgreSQL database.</p>
</li>
<li>
<p>In the pgAdmin <strong>Object Explorer</strong>, expand databases under your PostgreSQL server.</p>
</li>
<li>
<p>Right-click the <strong>contracts</strong> database and select <strong>Query Tool</strong> from the context menu.</p>
</li>
<li>
<p>Before you can run cypher queries, you must set the <code>ag_catalog</code> schema in your path:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">SQL</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">SET</span><span class="w"> </span><span class="n">search_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ag_catalog</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;$user&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">public</span><span class="p">;</span>
</code></pre></div></td></tr></table></div>
</li>
<li>
<p>Now, run the following cypher query to view vendors with open invoices, the details of those invoices, and verify your graph database was loaded correctly:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">SQL</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">-- View vendors and SOWs, along with invoice details from edge properties</span>
<span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ag_catalog</span><span class="p">.</span><span class="n">cypher</span><span class="p">(</span><span class="s1">&#39;vendor_graph&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">$$</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="p">:</span><span class="n">vendor</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="n">rel</span><span class="p">:</span><span class="n">has_invoices</span><span class="p">]</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">s</span><span class="p">:</span><span class="n">sow</span><span class="p">)</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">vendor_id</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">vendor_name</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">sow_id</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="nb">number</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">sow_number</span><span class="p">,</span><span class="w"> </span><span class="n">rel</span><span class="p">.</span><span class="n">payment_status</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">payment_status</span><span class="p">,</span><span class="w"> </span><span class="n">rel</span><span class="p">.</span><span class="n">amount</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">invoice_amount</span>
<span class="err">$$</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">graph_query</span><span class="p">(</span><span class="n">vendor_id</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span><span class="w"> </span><span class="n">vendor_name</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span><span class="w"> </span><span class="n">sow_id</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span><span class="w"> </span><span class="n">sow_number</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span><span class="w"> </span><span class="n">payment_status</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span><span class="w"> </span><span class="n">invoice_amount</span><span class="w"> </span><span class="nb">FLOAT</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
</li>
</ol>
<div class="admonition success">
<p class="admonition-title">Congratulations! You have successfully loaded your graph database with data from PostgreSQL.</p>
</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../06/" class="md-footer__link md-footer__link--prev" aria-label="Previous: 6.6 Export Graph Data">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                6.6 Export Graph Data
              </div>
            </div>
          </a>
        
        
          
          <a href="../08/" class="md-footer__link md-footer__link--next" aria-label="Next: 6.8 Update Copilot With GraphRAG">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                6.8 Update Copilot With GraphRAG
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 - present Microsoft

    </div>
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.expand", "navigation.instant.progress", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.path", "navigation.indexes", "navigation.top", "toc.follow", "navigation.footer", "content.code.copy", "content.tabs.link"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
  <!-- Add scripts that need to run before here -->
  
      <script src="../../assets/javascripts/bundle.60a45f97.min.js"></script>
      
    
  <!-- Add scripts that need to run afterwards here -->

    <!-- Place this tag in your head or just before your close body tag. -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    

  </body>
</html>